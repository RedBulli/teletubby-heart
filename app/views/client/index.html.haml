%iframe{:id => "channel", :src => @slide.url, :width => "100%", :height => "100%", :scrolling => "no"}
= subscribe_to "/channels/#{@channel.id}"
= subscribe_to "/clients/#{@client.id}"
:coffeescript
  $(document).ready ->
    startTime = new Date().getTime()
    duration = #{@slide.duration*1000}
    document.channelId = #{@channel.id}
    setInterval () ->
      elapsed = new Date().getTime() - startTime
      if(elapsed > duration)
        $.ajax
          type: 'GET'
          url: '/channels/'+document.channelId+'/next_slide'
          dataType: 'json'
          success: (data) ->
            duration = data.duration * 1000
            startTime = new Date().getTime()
            $('#channel').attr('src', data.url)
    , 1000